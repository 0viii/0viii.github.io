<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MiniDavid PRO</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

:root {
  --primary-color: #1DB954;
  --secondary-color: #191414;
  --text-primary: #FFFFFF;
  --text-secondary: #B3B3B3;
  --bg-sidebar: rgba(0, 0, 0, 0.85);
  --bg-card: rgba(24, 24, 24, 0.8);
  --bg-card-hover: rgba(40, 40, 40, 0.9);
  --bg-player: rgba(18, 18, 18, 0.95);
  --transition: all 0.3s ease;
}

body {
  font-family: 'Roboto', sans-serif;
  background: url('https://images6.alphacoders.com/105/1058970.jpg') no-repeat center center fixed;
  background-size: cover;
  color: var(--text-primary);
  transition: var(--transition);
  overflow-x: hidden;
}

body.light-mode {
  --primary-color: #1DB954;
  --secondary-color: #F2F2F2;
  --text-primary: #191414;
  --text-secondary: #5E5E5E;
  --bg-sidebar: rgba(255, 255, 255, 0.85);
  --bg-card: rgba(255, 255, 255, 0.8);
  --bg-card-hover: rgba(240, 240, 240, 0.9);
  --bg-player: rgba(245, 245, 245, 0.95);
}

.app-container {
  display: flex;
  min-height: 100vh;
  padding-bottom: 140px;
}

/* Sidebar mejorado */
.sidebar {
  width: 240px;
  background-color: var(--bg-sidebar);
  padding: 24px 16px;
  display: flex;
  flex-direction: column;
  border-right: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  flex-shrink: 0;
  position: fixed;
  left: 0;
  top: 0;
  bottom: 140px;
  z-index: 10;
  overflow-y: auto;
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 30px;
}

.sidebar h2 { 
  color: var(--primary-color); 
  font-size: 28px; 
  font-weight: 700;
}

.theme-toggle {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 18px;
  transition: var(--transition);
}

.theme-toggle:hover {
  color: var(--primary-color);
}

.sidebar nav {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 30px;
}

.nav-item {
  display: flex;
  align-items: center;
  gap: 16px;
  color: var(--text-secondary);
  text-decoration: none;
  font-weight: 500;
  padding: 10px 12px;
  border-radius: 8px;
  transition: var(--transition);
}

.nav-item:hover, .nav-item.active {
  color: var(--text-primary);
  background-color: rgba(255, 255, 255, 0.1);
}

.nav-item i {
  font-size: 20px;
  width: 24px;
  text-align: center;
}

.divider {
  height: 1px;
  background-color: rgba(255, 255, 255, 0.1);
  margin: 16px 0;
}

.playlist-section h3 {
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 1.5px;
  margin-bottom: 16px;
  color: var(--text-secondary);
}

.playlist-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 8px 12px;
  border-radius: 4px;
  cursor: pointer;
  transition: var(--transition;
  color: var(--text-secondary);
}

.playlist-item:hover {
  color: var(--text-primary);
}

.playlist-item i {
  font-size: 16px;
}

/* Contenido principal */
.main-content {
  flex: 1;
  margin-left: 240px;
  padding: 30px;
  transition: var(--transition);
}

.search-bar {
  display: flex;
  align-items: center;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 24px;
  padding: 8px 16px;
  margin-bottom: 24px;
  backdrop-filter: blur(10px);
  max-width: 400px;
}

.search-bar i {
  color: var(--text-secondary);
  margin-right: 12px;
}

.search-bar input {
  background: none;
  border: none;
  color: var(--text-primary);
  font-size: 16px;
  width: 100%;
  outline: none;
}

.search-bar input::placeholder {
  color: var(--text-secondary);
}

.page-header {
  margin-bottom: 24px;
}

.page-title {
  font-size: 28px;
  font-weight: 700;
  margin-bottom: 8px;
}

.page-subtitle {
  color: var(--text-secondary);
  font-size: 16px;
}

/* Lista de canciones mejorada */
.song-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 20px;
  margin-top: 24px;
}

.song-card {
  background-color: var(--bg-card);
  border-radius: 8px;
  padding: 16px;
  transition: var(--transition);
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.song-card:hover {
  background-color: var(--bg-card-hover);
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

.song-card-img {
  width: 100%;
  aspect-ratio: 1;
  border-radius: 4px;
  margin-bottom: 12px;
  object-fit: cover;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
}

.song-card-title {
  font-weight: 500;
  font-size: 16px;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.song-card-artist {
  color: var(--text-secondary);
  font-size: 14px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.song-card-actions {
  position: absolute;
  top: 12px;
  right: 12px;
  display: flex;
  gap: 8px;
  opacity: 0;
  transition: var(--transition);
}

.song-card:hover .song-card-actions {
  opacity: 1;
}

.action-btn {
  background: rgba(0, 0, 0, 0.7);
  border: none;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-primary);
  cursor: pointer;
  transition: var(--transition);
}

.action-btn:hover {
  background: var(--primary-color);
  transform: scale(1.1);
}

/* Lista de canciones clásica */
.song-list {
  margin-top: 24px;
  border-radius: 8px;
  overflow: hidden;
  background-color: var(--bg-card);
}

.song-row {
  display: grid;
  grid-template-columns: 50px 1fr 1fr 60px;
  align-items: center;
  padding: 12px 16px;
  transition: var(--transition);
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.song-row:hover {
  background-color: var(--bg-card-hover);
}

.song-row.active {
  background-color: rgba(29, 185, 84, 0.1);
}

.song-row-number {
  color: var(--text-secondary);
  font-size: 14px;
  text-align: center;
}

.song-row.active .song-row-number {
  color: var(--primary-color);
}

.song-row-title {
  display: flex;
  align-items: center;
  gap: 12px;
}

.song-row-img {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  object-fit: cover;
}

.song-row-info {
  display: flex;
  flex-direction: column;
}

.song-row-name {
  font-weight: 500;
}

.song-row-artist {
  font-size: 12px;
  color: var(--text-secondary);
}

.song-row-album {
  color: var(--text-secondary);
  font-size: 14px;
}

.song-row-duration {
  color: var(--text-secondary);
  text-align: right;
  font-size: 14px;
}

/* Reproductor mejorado */
.player {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 140px;
  background-color: var(--bg-player);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  gap: 16px;
  z-index: 100;
  backdrop-filter: blur(10px);
}

.player-left {
  display: flex;
  align-items: center;
  gap: 12px;
  flex: 0 0 30%;
}

.player-album {
  width: 60px;
  height: 60px;
  border-radius: 8px;
  object-fit: cover;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
}

.player-info {
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.player-song {
  font-weight: 500;
  font-size: 14px;
  margin-bottom: 4px;
}

.player-artist {
  font-size: 12px;
  color: var(--text-secondary);
}

.player-like {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 14px;
  margin-left: 12px;
  transition: var(--transition);
}

.player-like:hover, .player-like.active {
  color: var(--primary-color);
}

.player-center {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 0 0 40%;
  gap: 8px;
}

.player-controls {
  display: flex;
  align-items: center;
  gap: 16px;
}

.player-btn {
  background: none;
  border: none;
  color: var(--text-primary);
  cursor: pointer;
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
}

.player-btn:hover {
  color: var(--primary-color);
}

.player-btn.play-pause {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background-color: var(--text-primary);
  color: var(--secondary-color);
}

.player-btn.play-pause:hover {
  transform: scale(1.05);
  background-color: var(--primary-color);
  color: var(--text-primary);
}

.player-progress {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 12px;
}

.player-time {
  font-size: 12px;
  color: var(--text-secondary);
  min-width: 40px;
}

.progress-container {
  flex: 1;
  height: 6px;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 3px;
  cursor: pointer;
  position: relative;
}

.progress-bar {
  height: 6px;
  background: var(--primary-color);
  border-radius: 3px;
  width: 0%;
  position: relative;
  transition: width 0.1s ease;
}

.progress-handle {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--text-primary);
  position: absolute;
  top: 50%;
  right: 0;
  transform: translate(50%, -50%);
  opacity: 0;
  transition: opacity 0.2s ease;
}

.progress-container:hover .progress-handle {
  opacity: 1;
}

.player-right {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  flex: 0 0 30%;
  gap: 16px;
}

.volume-container {
  display: flex;
  align-items: center;
  gap: 8px;
}

.volume-btn {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 16px;
  transition: var(--transition);
}

.volume-btn:hover {
  color: var(--text-primary);
}

.volume-slider {
  width: 80px;
  height: 4px;
  -webkit-appearance: none;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 2px;
  outline: none;
}

.volume-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: var(--text-primary);
  cursor: pointer;
  transition: var(--transition);
}

.volume-slider::-webkit-slider-thumb:hover {
  background: var(--primary-color);
}

.player-queue {
  background: none;
  border: none;
  color: var(--text-secondary);
  cursor: pointer;
  font-size: 16px;
  transition: var(--transition);
}

.player-queue:hover {
  color: var(--text-primary);
}

/* Visualizador de audio */
.visualizer {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  height: 40px;
  gap: 2px;
  margin-top: 8px;
}

.visualizer-bar {
  width: 3px;
  background-color: var(--primary-color);
  border-radius: 2px;
  transition: height 0.2s ease;
}

/* Responsive */
@media (max-width: 1024px) {
  .sidebar {
    width: 80px;
    padding: 24px 8px;
    align-items: center;
  }
  
  .sidebar h2 {
    font-size: 18px;
  }
  
  .nav-item span, .playlist-section h3, .playlist-item span {
    display: none;
  }
  
  .main-content {
    margin-left: 80px;
  }
  
  .song-grid {
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  }
}

@media (max-width: 768px) {
  .sidebar {
    bottom: 0;
    width: 100%;
    height: 70px;
    flex-direction: row;
    justify-content: space-around;
    padding: 0;
    border-right: none;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
  }
  
  .sidebar-header, .divider, .playlist-section {
    display: none;
  }
  
  .sidebar nav {
    flex-direction: row;
    margin-bottom: 0;
    gap: 0;
    width: 100%;
    justify-content: space-around;
  }
  
  .nav-item {
    padding: 16px 12px;
    flex-direction: column;
    gap: 4px;
  }
  
  .nav-item i {
    font-size: 20px;
  }
  
  .main-content {
    margin-left: 0;
    padding: 20px 16px;
    padding-bottom: 90px;
  }
  
  .player {
    flex-direction: column;
    height: auto;
    padding: 12px;
  }
  
  .player-left, .player-center, .player-right {
    width: 100%;
    justify-content: center;
  }
  
  .player-left {
    flex: 0;
  }
  
  .player-center {
    margin: 8px 0;
  }
  
  .player-right {
    margin-top: 8px;
  }
  
  .song-grid {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 12px;
  }
  
  .song-row {
    grid-template-columns: 30px 1fr 50px;
  }
  
  .song-row-album {
    display: none;
  }
}

/* Animaciones */
@keyframes pulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.05); }
  100% { transform: scale(1); }
}

.pulse {
  animation: pulse 0.5s ease-in-out;
}

/* Scrollbar personalizado */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.2);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.3);
}

/* Vista de lista/cuadrícula */
.view-toggle {
  display: flex;
  margin-left: auto;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  overflow: hidden;
}

.view-btn {
  background: none;
  border: none;
  padding: 8px 12px;
  color: var(--text-secondary);
  cursor: pointer;
  transition: var(--transition);
}

.view-btn.active {
  background: rgba(255, 255, 255, 0.2);
  color: var(--text-primary);
}

.view-btn:hover {
  color: var(--text-primary);
}

.hidden {
  display: none;
}
</style>
</head>
<body>
<div class="app-container">
  <!-- Sidebar mejorado -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <h2>MiniDavid</h2>
      <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
      </button>
    </div>
    
    <nav>
      <a href="#" class="nav-item active">
        <i class="fas fa-home"></i>
        <span>Inicio</span>
      </a>
      <a href="#" class="nav-item">
        <i class="fas fa-search"></i>
        <span>Explorar</span>
      </a>
      <a href="#" class="nav-item">
        <i class="fas fa-book"></i>
        <span>Tu Biblioteca</span>
      </a>
    </nav>
    
    <div class="divider"></div>
    
    <div class="playlist-section">
      <h3>Playlists</h3>
      <a href="#" class="playlist-item">
        <i class="fas fa-plus"></i>
        <span>Crear playlist</span>
      </a>
      <a href="#" class="playlist-item">
        <i class="fas fa-heart"></i>
        <span>Tus me gusta</span>
      </a>
    </div>
  </aside>

  <!-- Contenido principal -->
  <main class="main-content">
    <div class="search-bar">
      <i class="fas fa-search"></i>
      <input type="text" placeholder="Buscar canciones, artistas o álbumes..." id="searchInput">
    </div>
    
    <div class="page-header">
      <h1 class="page-title">Buenos días</h1>
      <p class="page-subtitle">Disfruta de tu música favorita</p>
    </div>
    
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
      <h2 class="section-title">Canciones Destacadas</h2>
      <div class="view-toggle">
        <button class="view-btn active" id="gridViewBtn">
          <i class="fas fa-th"></i>
        </button>
        <button class="view-btn" id="listViewBtn">
          <i class="fas fa-list"></i>
        </button>
      </div>
    </div>
    
    <div class="song-grid" id="songGridView"></div>
    <div class="song-list hidden" id="songListView"></div>
  </main>
</div>

<!-- Reproductor de música -->
<div class="player">
  <div class="player-left">
    <img id="player-img" src="" alt="Álbum" class="player-album">
    <div class="player-info">
      <p id="player-song" class="player-song">Canción</p>
      <p id="player-artist" class="player-artist">Artista</p>
    </div>
    <button class="player-like" id="player-like">
      <i class="far fa-heart"></i>
    </button>
  </div>
  
  <div class="player-center">
    <div class="player-controls">
      <button class="player-btn" id="shuffle">
        <i class="fas fa-random"></i>
      </button>
      <button class="player-btn" id="prev">
        <i class="fas fa-step-backward"></i>
      </button>
      <button class="player-btn play-pause" id="play">
        <i class="fas fa-play" id="play-icon"></i>
      </button>
      <button class="player-btn" id="next">
        <i class="fas fa-step-forward"></i>
      </button>
      <button class="player-btn" id="repeat">
        <i class="fas fa-redo"></i>
      </button>
    </div>
    
    <div class="player-progress">
      <span class="player-time" id="current-time">00:00</span>
      <div class="progress-container" id="progress-container">
        <div class="progress-bar" id="progress-bar">
          <div class="progress-handle"></div>
        </div>
      </div>
      <span class="player-time" id="total-time">00:00</span>
    </div>
    
    <div class="visualizer" id="visualizer"></div>
  </div>
  
  <div class="player-right">
    <div class="volume-container">
      <button class="volume-btn" id="volume-btn">
        <i class="fas fa-volume-up"></i>
      </button>
      <input type="range" class="volume-slider" id="volume" min="0" max="1" step="0.01" value="0.8">
    </div>
    <button class="player-queue" id="queue-btn">
      <i class="fas fa-list"></i>
    </button>
  </div>
</div>

<div id="yt-player"></div>

<script>
let player;
let isPlaying = false;
let currentSong = 0;
let isShuffle = false;
let isRepeat = false;
let likedSongs = JSON.parse(localStorage.getItem('likedSongs')) || [];

// Lista de canciones mejorada
const songs = [
  {id:'f1iiTXwcXq0', title:'LVL', artist:'A$AP Rocky', img:'https://i.ytimg.com/vi/f1iiTXwcXq0/hqdefault.jpg', duration: '3:10'},
  {id:'t7aY6lJ77BM', title:'Tu Boda', artist:'Desconocido', img:'https://i.ytimg.com/vi/t7aY6lJ77BM/hqdefault.jpg', duration: '2:45'},
  {id:'JzkP_5E03P4', title:'Blinding Lights', artist:'The Weeknd', img:'https://i.ytimg.com/vi/JzkP_5E03P4/hqdefault.jpg', duration: '3:20'},
  {id:'JGwWNGJdvx8', title:'Shape of You', artist:'Ed Sheeran', img:'https://i.ytimg.com/vi/JGwWNGJdvx8/hqdefault.jpg', duration: '3:54'},
  {id:'kJQP7kiw5Fk', title:'Despacito', artist:'Luis Fonsi', img:'https://i.ytimg.com/vi/kJQP7kiw5Fk/hqdefault.jpg', duration: '3:48'},
  {id:'OPf0YbXqDm0', title:'Uptown Funk', artist:'Mark Ronson', img:'https://i.ytimg.com/vi/OPf0YbXqDm0/hqdefault.jpg', duration: '4:30'},
  {id:'AJtDXIazrMo', title:'Thinking Out Loud', artist:'Ed Sheeran', img:'https://i.ytimg.com/vi/AJtDXIazrMo/hqdefault.jpg', duration: '4:41'},
  {id:'09R8_2nJtjg', title:'Sugar', artist:'Maroon 5', img:'https://i.ytimg.com/vi/09R8_2nJtjg/hqdefault.jpg', duration: '3:55'},
];

// Inicializar la aplicación
function init() {
  renderSongs();
  setupEventListeners();
  loadYouTubeAPI();
}

// Renderizar canciones en ambas vistas
function renderSongs() {
  const gridView = document.getElementById('songGridView');
  const listView = document.getElementById('songListView');
  
  gridView.innerHTML = '';
  listView.innerHTML = '';
  
  songs.forEach((song, index) => {
    // Vista de cuadrícula
    const card = document.createElement('div');
    card.classList.add('song-card');
    card.dataset.index = index;
    
    card.innerHTML = `
      <img src="${song.img}" alt="${song.title}" class="song-card-img">
      <h3 class="song-card-title">${song.title}</h3>
      <p class="song-card-artist">${song.artist}</p>
      <div class="song-card-actions">
        <button class="action-btn like-btn" data-index="${index}">
          <i class="${likedSongs.includes(index) ? 'fas' : 'far'} fa-heart"></i>
        </button>
        <button class="action-btn play-btn" data-index="${index}">
          <i class="fas fa-play"></i>
        </button>
      </div>
    `;
    
    card.addEventListener('click', (e) => {
      if (!e.target.closest('.song-card-actions')) {
        playSong(index);
      }
    });
    
    gridView.appendChild(card);
    
    // Vista de lista
    const row = document.createElement('div');
    row.classList.add('song-row');
    row.dataset.index = index;
    
    row.innerHTML = `
      <div class="song-row-number">${index + 1}</div>
      <div class="song-row-title">
        <img src="${song.img}" alt="${song.title}" class="song-row-img">
        <div class="song-row-info">
          <span class="song-row-name">${song.title}</span>
          <span class="song-row-artist">${song.artist}</span>
        </div>
      </div>
      <div class="song-row-album">Álbum</div>
      <div class="song-row-duration">${song.duration}</div>
    `;
    
    row.addEventListener('click', () => playSong(index));
    listView.appendChild(row);
  });
  
  // Actualizar botones de like
  document.querySelectorAll('.like-btn').forEach(btn => {
    const index = parseInt(btn.dataset.index);
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleLike(index);
    });
  });
  
  // Actualizar botones de play
  document.querySelectorAll('.play-btn').forEach(btn => {
    const index = parseInt(btn.dataset.index);
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      playSong(index);
    });
  });
}

// Configurar event listeners
function setupEventListeners() {
  // Toggle tema claro/oscuro
  document.getElementById('themeToggle').addEventListener('click', toggleTheme);
  
  // Toggle vistas
  document.getElementById('gridViewBtn').addEventListener('click', () => toggleView('grid'));
  document.getElementById('listViewBtn').addEventListener('click', () => toggleView('list'));
  
  // Botones del reproductor
  document.getElementById('play').addEventListener('click', togglePlay);
  document.getElementById('next').addEventListener('click', playNext);
  document.getElementById('prev').addEventListener('click', playPrev);
  document.getElementById('shuffle').addEventListener('click', toggleShuffle);
  document.getElementById('repeat').addEventListener('click', toggleRepeat);
  document.getElementById('player-like').addEventListener('click', () => toggleLike(currentSong));
  
  // Barra de progreso
  document.getElementById('progress-container').addEventListener('click', seek);
  
  // Volumen
  document.getElementById('volume').addEventListener('input', setVolume);
  document.getElementById('volume-btn').addEventListener('click', toggleMute);
  
  // Búsqueda
  document.getElementById('searchInput').addEventListener('input', searchSongs);
}

// Toggle tema claro/oscuro
function toggleTheme() {
  document.body.classList.toggle('light-mode');
  const icon = document.querySelector('#themeToggle i');
  if (document.body.classList.contains('light-mode')) {
    icon.classList.remove('fa-moon');
    icon.classList.add('fa-sun');
  } else {
    icon.classList.remove('fa-sun');
    icon.classList.add('fa-moon');
  }
}

// Toggle entre vistas de cuadrícula y lista
function toggleView(viewType) {
  const gridView = document.getElementById('songGridView');
  const listView = document.getElementById('songListView');
  const gridBtn = document.getElementById('gridViewBtn');
  const listBtn = document.getElementById('listViewBtn');
  
  if (viewType === 'grid') {
    gridView.classList.remove('hidden');
    listView.classList.add('hidden');
    gridBtn.classList.add('active');
    listBtn.classList.remove('active');
  } else {
    gridView.classList.add('hidden');
    listView.classList.remove('hidden');
    gridBtn.classList.remove('active');
    listBtn.classList.add('active');
  }
}

// Toggle like en una canción
function toggleLike(index) {
  const likeIndex = likedSongs.indexOf(index);
  if (likeIndex === -1) {
    likedSongs.push(index);
  } else {
    likedSongs.splice(likeIndex, 1);
  }
  
  // Guardar en localStorage
  localStorage.setItem('likedSongs', JSON.stringify(likedSongs));
  
  // Actualizar iconos
  document.querySelectorAll(`.like-btn[data-index="${index}"] i`).forEach(icon => {
    icon.classList.toggle('far');
    icon.classList.toggle('fas');
  });
  
  // Actualizar botón del reproductor si es la canción actual
  if (index === currentSong) {
    const playerLike = document.getElementById('player-like').querySelector('i');
    playerLike.classList.toggle('far');
    playerLike.classList.toggle('fas');
  }
}

// Cargar API de YouTube
function loadYouTubeAPI() {
  const tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  const firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
}

// Crear reproductor cuando la API esté lista
function onYouTubeIframeAPIReady() {
  player = new YT.Player('yt-player', {
    height: '0',
    width: '0',
    videoId: songs[currentSong].id,
    playerVars: {
      'autoplay': 0,
      'controls': 0,
      'rel': 0,
      'modestbranding': 1
    },
    events: {
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

function onPlayerReady(event) {
  updatePlayerInfo();
  createVisualizer();
}

function playSong(index) {
  currentSong = index;
  player.loadVideoById(songs[currentSong].id);
  updatePlayerInfo();
  isPlaying = true;
  updatePlayButton();
  
  // Resaltar canción actual
  document.querySelectorAll('.song-row').forEach(row => row.classList.remove('active'));
  document.querySelectorAll('.song-row').forEach(row => {
    if (parseInt(row.dataset.index) === currentSong) {
      row.classList.add('active');
    }
  });
}

function updatePlayerInfo() {
  document.getElementById('player-song').innerText = songs[currentSong].title;
  document.getElementById('player-artist').innerText = songs[currentSong].artist;
  document.getElementById('player-img').src = songs[currentSong].img;
  
  // Actualizar like
  const likeIcon = document.getElementById('player-like').querySelector('i');
  if (likedSongs.includes(currentSong)) {
    likeIcon.classList.remove('far');
    likeIcon.classList.add('fas');
  } else {
    likeIcon.classList.remove('fas');
    likeIcon.classList.add('far');
  }
}

function togglePlay() {
  if (isPlaying) {
    player.pauseVideo();
  } else {
    player.playVideo();
  }
  isPlaying = !isPlaying;
  updatePlayButton();
}

function updatePlayButton() {
  const playIcon = document.getElementById('play-icon');
  if (isPlaying) {
    playIcon.classList.remove('fa-play');
    playIcon.classList.add('fa-pause');
  } else {
    playIcon.classList.remove('fa-pause');
    playIcon.classList.add('fa-play');
  }
}

function playNext() {
  if (isShuffle) {
    let randomIndex;
    do {
      randomIndex = Math.floor(Math.random() * songs.length);
    } while (randomIndex === currentSong && songs.length > 1);
    playSong(randomIndex);
  } else {
    playSong((currentSong + 1) % songs.length);
  }
}

function playPrev() {
  if (player.getCurrentTime() > 3) {
    player.seekTo(0);
  } else {
    playSong((currentSong - 1 + songs.length) % songs.length);
  }
}

function toggleShuffle() {
  isShuffle = !isShuffle;
  const shuffleBtn = document.getElementById('shuffle');
  shuffleBtn.style.color = isShuffle ? 'var(--primary-color)' : 'var(--text-primary)';
}

function toggleRepeat() {
  isRepeat = !isRepeat;
  const repeatBtn = document.getElementById('repeat');
  repeatBtn.style.color = isRepeat ? 'var(--primary-color)' : 'var(--text-primary)';
}

function setVolume() {
  const volume = document.getElementById('volume').value;
  player.setVolume(volume * 100);
  
  // Actualizar icono de volumen
  const volumeIcon = document.getElementById('volume-btn').querySelector('i');
  if (volume == 0) {
    volumeIcon.classList.remove('fa-volume-up');
    volumeIcon.classList.remove('fa-volume-down');
    volumeIcon.classList.add('fa-volume-mute');
  } else if (volume < 0.5) {
    volumeIcon.classList.remove('fa-volume-up');
    volumeIcon.classList.remove('fa-volume-mute');
    volumeIcon.classList.add('fa-volume-down');
  } else {
    volumeIcon.classList.remove('fa-volume-down');
    volumeIcon.classList.remove('fa-volume-mute');
    volumeIcon.classList.add('fa-volume-up');
  }
}

function toggleMute() {
  if (player.isMuted()) {
    player.unMute();
    document.getElementById('volume').value = 0.8;
  } else {
    player.mute();
    document.getElementById('volume').value = 0;
  }
  setVolume();
}

function seek(e) {
  const progressContainer = document.getElementById('progress-container');
  const width = progressContainer.clientWidth;
  const clickX = e.offsetX;
  const duration = player.getDuration();
  player.seekTo((clickX / width) * duration);
}

function onPlayerStateChange(event) {
  if (event.data === YT.PlayerState.PLAYING) {
    isPlaying = true;
    updatePlayButton();
    startProgressTimer();
    startVisualizer();
  } else if (event.data === YT.PlayerState.PAUSED) {
    isPlaying = false;
    updatePlayButton();
    stopVisualizer();
  } else if (event.data === YT.PlayerState.ENDED) {
    if (isRepeat) {
      player.playVideo();
    } else {
      playNext();
    }
  }
}

function startProgressTimer() {
  function update() {
    if (player && player.getCurrentTime) {
      const currentTime = player.getCurrentTime();
      const duration = player.getDuration();
      const percent = (currentTime / duration) * 100;
      
      document.getElementById('progress-bar').style.width = percent + '%';
      document.getElementById('current-time').textContent = formatTime(currentTime);
      document.getElementById('total-time').textContent = formatTime(duration);
      
      if (isPlaying) {
        requestAnimationFrame(update);
      }
    }
  }
  update();
}

function formatTime(seconds) {
  const min = Math.floor(seconds / 60);
  const sec = Math.floor(seconds % 60);
  return `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
}

function createVisualizer() {
  const visualizer = document.getElementById('visualizer');
  visualizer.innerHTML = '';
  
  for (let i = 0; i < 20; i++) {
    const bar = document.createElement('div');
    bar.classList.add('visualizer-bar');
    bar.style.height = `${Math.random() * 20 + 5}px`;
    visualizer.appendChild(bar);
  }
}

function startVisualizer() {
  const bars = document.querySelectorAll('.visualizer-bar');
  
  function animate() {
    bars.forEach(bar => {
      if (isPlaying) {
        bar.style.height = `${Math.random() * 30 + 5}px`;
      }
    });
    
    if (isPlaying) {
      setTimeout(animate, 100);
    }
  }
  
  animate();
}

function stopVisualizer() {
  const bars = document.querySelectorAll('.visualizer-bar');
  bars.forEach(bar => {
    bar.style.height = '5px';
  });
}

function searchSongs() {
  const query = document.getElementById('searchInput').value.toLowerCase();
  
  document.querySelectorAll('.song-card, .song-row').forEach((element, index) => {
    const song = songs[index];
    const matches = song.title.toLowerCase().includes(query) || 
                    song.artist.toLowerCase().includes(query);
    
    if (query === '' || matches) {
      element.style.display = 'flex';
    } else {
      element.style.display = 'none';
    }
  });
}

// Inicializar la aplicación cuando el DOM esté listo
document.addEventListener('DOMContentLoaded', init);
</script>

</body>
  </html>
